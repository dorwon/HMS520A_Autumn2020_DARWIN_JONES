install.packages("sjPlot")
library(sjPlot)
plot_model(fit)
fit <- lmer(obs ~ cov1 * exposure + (1|study_id1),
data = dt)
plot_model(fit)
# graph all predictions
effects <- effects::effect(mod= mod)
plot_model(fit, type = "slope")
plot_model(fit, type = "diag")
plot_model(fit, type = 'resid')
fit
fit <- lmer(obs ~ cov1 (1 + exposure|study_id1),
data = dt)
View(dt)
fit <- lmer(obs ~ cov1 + (1 + exposure|study_id1),
data = dt)
fit
plot_model(fit)
fit <- lmer(obs ~ cov1*study_id1 + (1 + exposure|study_id1),
data = dt)
plot_model(fit)
fit <- lmer(obs ~ cov1*exposure + (1 + exposure|study_id1),
data = dt)
plot_model(fit)
dt_fit <- fit <- fortify.merMod(fit)
View(dt_fit)
fit_model(fit)
install.packages('sjPlotGLME')
library(sjPlot)
sjPlot::plot_scatter(fit, cov1, obs)
sjPlot::plot_scatter(fit, cov1, obs, study_id1)
predict(fit)
frir <- predict(fit)
frir <- predict(dd)
str(fit)
View(dt_fit)
str(dt_fit)
predict.lm(fit)
fit <- lmer(obs ~ cov1*exposure + (1 + exposure|study_id1),
data = dt)
dt$fit <- predict(fit)
View(dt)
ggplot(data = dt]) + geom_line(aes(cov1, fit))
ggplot(data = dt) + geom_line(aes(cov1, fit))
ggplot(dt, aes(cov1, fit), color = study_id1) + geom_line(aes(cov1, fit))
ggplot(dt, aes(cov1, fit), color = study_id1) + geom_line()
ggplot(dt, aes(cov1, fit, color = study_id1)) + geom_line()
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) + geom_line()
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
geom_point(aes(cov, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
geom_point(aes(cov1, obs))
fit
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
geom_point(aes(cov1, obs)) +
stat_summary()
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
stat_summary() +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
stat_summary() +
geom_point(aes(cov1, obs)) +
stat_summary(aes(y=.fitted), fun.y=mean, geom="line")
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
stat_summary() +
geom_point(aes(cov1, obs)) +
stat_summary(aes(y=.fitted), fun=mean, geom="line")
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
stat_summary() +
geom_point(aes(cov1, obs)) +
stat_summary(aes(y=fit), fun=mean, geom="line")
fit
fit <- lmer(obs ~ cov1 + (1 + exposure|study_id1),
data = dt)
dt$fit <- predict(fit)
dt_fit <- fit <- fortify.merMod(fit)
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
stat_summary() +
geom_point(aes(cov1, obs)) +
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
stat_summary() +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
stat_summary() +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
geom_point(aes(cov1, obs))
fit
fit <- lmer(obs ~ cov1 + (1 + exposure|study_id1),
data = dt)
dt$fit <- predict(fit)
fit
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_line() +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_boxplot() +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_boxplot() +
geom_linerange()
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_boxplot() +
geom_linerange() +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_boxplot() +
geom_linerange() +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_boxplot() +
geom_ribbon() +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_boxplot() +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_boxplot(ymax = 1, ymin = 2) +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_boxplot(ymax = 1, ymin = 0) +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(ymax = 1, ymin = 0) +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = 1, ymin = 0)) +
geom_point(aes(cov1, obs))
vignette("ggplot2-specs")
fit
dt$error <- 1.0193 / 10
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error)) +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs))
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 4)
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(exposure, obs), size = 4)
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
subset(dt,subset = study_id1 == 1)
graphs <- rep(NA,10)
for(i in 1:10) {
graph[i] <- ggplot(subset(dt, study_id == i), aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
graphs <- rep(NA,10)
for(i in 1:10) {
graph[i] <- ggplot(subset(dt, study_id1 == i), aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
graphs <- rep(NA,10)
for(i in 1:10) {
graphs[i] <- ggplot(subset(dt, study_id1 == i), aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
graphs[i] <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
for(i in 1:10) {
graphs[i] <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
subset(dt, study_id1 == 1)
gomp <- subset(dt, study_id1 == 1)
ggplot(gomp, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
graphs <- rep(NA,10)
graphs <- rep(NA,10)
for(i in 1:10) {
sub <- subset(dt, study_id1 == i)
graphs[i] <- ggplot(sub, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
typeof(1:10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[i] <- ggplot(sub, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[i] <- ggplot(sub, aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
View(graphs)
grid.arrange(graphs, nrow = 1)
grid.arrange(graphs[1], nrow = 1)
graphs <- rep(NA,10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
print(sub)
graphs[i] <- ggplot(sub, aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
graphs[i] <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
print(sub)
graphs[i] <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
graphs <- list(NA,NA,NA)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[i] <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
graphs <- list(NA,NA,NA)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
sill <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
grid.arrange(graphs[1], nrow = 1)
grid.arrange(sill, nrow = 1)
graphs <- data.table(dim(2))
View(graphs)
e
graphs <- data.table
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs$i <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
graphs <- array(dim = 10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs$i <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
View(graphs)
graphs[1] <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
View(graphs)
graphs <- array(dim = 11)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[1] <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
graphs <- array(dim = 10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[1] <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
graphs <- list(dim = 10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[1] <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
View(graphs)
graphs <- list(data = NA, dim = 10)
View(graphs)
graphs <- array(data = NA, dim = 10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[1] <- ggplot(subset(dt, study_id1 == 1), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
debugSource('~/hms520jones/homeworks/homework5.R')
graphs[1] <- ggplot(subset(dt, study_id1 == i), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
graphs <- array(data = NA, dim = 10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[1] <- ggplot(subset(dt, study_id1 == i), aes_string(x = 'cov1', y = fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
graphs[1] <- ggplot(subset(dt, study_id1 == i), aes_string(x = 'cov1', y = 'fit')) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
graphs <- list(data = NA, dim = 10)
ggplot(dt, aes(cov1, fit, color = factor(study_id1))) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
?list
graphs <- vector('list', 10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(subset(dt, study_id1 == i), aes_string(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(subset(dt, study_id1 == i), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
View(graphs)
graphs <- vector('list', 10)
View(graphs)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[i] <- ggplot(subset(dt, study_id1 == i), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
?grid.arrange
grid.arrange(graphs, nrow = 2)
grid.arrange(grobs = graphs, nrow = 2)
grid.arrange(graphs[[1]], graphs[[2]], nrow = 2)
graphs
graphs[[1]]
View(graphs)
ggplot(subset(dt, study_id1 == i), aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
dt$study_id1[1]
dt$study_id1[1] ==
9
dt$study_id1[1] == 9L
graphs <- vector('list', 10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2)
}
grid.arrange(graphs[[1]], graphs[[2]], nrow = 2)
grid.arrange(graphs, nrow = 2)
grid.arrange(grob = graphs, nrow = 2)
grid.arrange(grobs = graphs, nrow = 2)
graphs <- vector('list', 10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
RColorBrewer::display.brewer.all()
RColorBrewer::brewer.pal()
RColorBrewer::brewer.pal("Set3")
RColorBrewer::brewer.pal(name="Set3")
RColorBrewer::brewer.pal(name="Set3", n=10)
colors <- RColorBrewer::brewer.pal(name="Set3", n=10)
colors <- RColorBrewer::brewer.pal(name="Set3", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit, colour = colors[i])) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
graphs <- vector('list', 10)
colors <- RColorBrewer::brewer.pal(name="Set3", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit, colour = study_id1)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
graphs[[i]] <- ggplot(sub, aes(cov1, fit, colour = factor(study_id1)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
graphs <- vector('list', 10)
colors <- RColorBrewer::brewer.pal(name="Set3", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
print(colors[i])
graphs[[i]] <- ggplot(sub, aes(cov1, fit, colour = colors[i])) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
graphs <- vector('list', 10)
colors <- RColorBrewer::brewer.pal(name="Set3", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit, colour = colors)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
graphs[[i]] <- ggplot(sub, aes(cov1, fit, colour = "blue")) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
colors <- RColorBrewer::brewer.pal(name="Set3", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit, colour = "blue")) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
graphs <- vector('list', 10)
colors <- RColorBrewer::brewer.pal(name="Set3", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit, color = "blue")) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05) +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
graphs[[i]] <- ggplot(sub, aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05, color = 'blue') +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
colors <- RColorBrewer::brewer.pal(name="Set3", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05, color = 'blue') +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
graphs <- vector('list', 10)
colors <- RColorBrewer::brewer.pal(name="Set3", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05, color = colors[i]) +
geom_point(aes(cov1, obs), size = 2) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
graphs <- vector('list', 10)
colors <- RColorBrewer::brewer.pal(name="Set3", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05, color = colors[i]) +
geom_point(aes(cov1, obs), size = 2, color = colors[i]) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
graphs <- vector('list', 10)
colors <- RColorBrewer::brewer.pal(name="Set2", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05, color = colors[i]) +
geom_point(aes(cov1, obs), size = 2, color = colors[i]) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
colors <- RColorBrewer::brewer.pal(name="Paired", n=10)
for(i in seq(1,10)){
sub <- subset(dt, study_id1 == i)
graphs[[i]] <- ggplot(sub, aes(cov1, fit)) +
geom_ribbon(aes(ymax = obs+error, ymin = obs-error), alpha = 0.05, color = colors[i]) +
geom_point(aes(cov1, obs), size = 2, color = colors[i]) +
ggtitle(paste0("Study #",i))
}
grid.arrange(grobs = graphs, nrow = 2)
